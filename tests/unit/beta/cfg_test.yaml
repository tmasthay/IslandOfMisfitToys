unbatch_splines:
  freq: [1.0, 3.0]
  x:
    left: 0.0
    right: 6.28
    num_ref: 100
    upsample: 10
  pad: 30

prob:
  mu: [-1.0, 1.0]
  sigma: [0.1, 1.0]
  x: [-5, 5, 1000]
  p:
    eps: 0.01
    np: 1000
  renorm: ^^null|misfit_toys.beta.renorm|identity
  mesh_perturb: 0.5

  plot:
    pdf:
      mode: fail
      max: 10
    cdf:
      mode: fail
      max: 10
    disc_quantile:
      mode: fail
      max: 10
    cts_quantile:
      mode: fail
      max: 10

w2:
  x: [-10, 10, 1000]
  mu1: [-1.0, 1.0]
  sigma1: [0.1, 1.0]
  mu2: ${.mu1}
  sigma2: ${.sigma1}
  renorm: ^^null|misfit_toys.beta.renorm|identity
  p:
    eps: 0.01
    np: 1000
  atol: 1.0e-01
  rtol: 1.0e-01

  plot:
    w2:
      mode: always
      max: 25

conv:
  x:
    specs: [0.0, 1.0, 300]
    device: cuda:1
  p:
    eps: 0.01
    np: 1000
    device: cuda:1
  nepochs: 1000
  num_plots: 10
  atol: 1.0e-02
  rtol: 1.0e-02
  data:
    runtime_func: ^^null|misfit_toys.beta.data|gaussian_mixture
    kw:
      x: self.unit.beta.conv.x
      mu: [0.3, 0.5, 0.7]
      sigma: [0.005, 0.005, 0.01]
      weights: [0.2, 0.3, 0.5]
    # runtime_func: ^^null|misfit_toys.beta.data|gaussian
    # kw:
    #   x: self.unit.beta.conv.x
  init_guess:
    runtime_func: ^^null|misfit_toys.beta.data|sine_wave
    kw:
      x: self.unit.beta.conv.x
  # init_guess:
  #   runtime_func: ^^null|misfit_toys.beta.data|gaussian_mixture
  #   kw:
  #     x: self.unit.beta.conv.x
  #     mu: [0.2, 0.6]
  #     sigma: [0.01, 0.01]
  #     weights: [0.1, 0.9]
  subtests:
    # dummy list to index with strings due to dynamic import support lacking
    #      for lists
    "0":
      name: cdf_sgd
      loss_fn:
        runtime_func: ^^null|misfit_toys.beta.loss|sobolev
        kw:
          # renorm:
          #   runtime_func: ^^null|misfit_toys.beta.renorm|softplus
          #   kw:
          #     k: 2.0
          x: self.unit.beta.conv.x
          # p: self.unit.beta.conv.p
          scale: 0.0
      optimizer:
        runtime_func: ^^null|misfit_toys.beta.opt|delay_opt
        kw:
          opt_type: ^^null|torch.optim|SGD
          lr: 5.0e-01
      data: self.unit.beta.conv.data
      init_guess: self.unit.beta.conv.init_guess
      device: cuda:1
      plot:
        sub:
          shape: [4, 2]
          kw:
            figsize: [10, 10]
        mode: always
        max_plots: 25
        int_plotter: ^^null|misfit_toys.beta.plotter|trace_group_stack_plotter
        iter:
          none_dims: [-1]
        save:
          duration: 1000
      atol: 1.0e-02
      rtol: 1.0e-01

    "1":
      name: mse_sgd
      loss_fn: ^^null|misfit_toys.beta.loss|mse
      optimizer:
        runtime_func: ^^null|misfit_toys.beta.opt|delay_opt
        kw:
          opt_type: ^^null|torch.optim|SGD
          lr: 0.5
      data: self.unit.beta.conv.data
      init_guess: self.unit.beta.conv.init_guess
      device: cuda:1
      plot:
        sub:
          shape: [2, 2]
          kw:
            figsize: [10, 10]
        mode: always
        max_plots: 25
        iter:
          none_dims: [-1]
        save:
          duration: 1000
      atol: 1.0e-02
      rtol: 1.0e-01

    "2":
      name: pdf_adam
      loss_fn:
        runtime_func: ^^null|misfit_toys.beta.loss|sobolev
        kw:
          # renorm:
          #   runtime_func: ^^null|misfit_toys.beta.renorm|softplus
          #   kw:
          #     k: 1.0
          x: self.unit.beta.conv.x
          # p: self.unit.beta.conv.p
          scale: 0.0
      optimizer:
        runtime_func: ^^null|misfit_toys.beta.opt|delay_opt
        kw:
          opt_type: ^^null|torch.optim|Adam
          lr: 1.0e-01
      data: self.unit.beta.conv.data
      init_guess: self.unit.beta.conv.init_guess
      device: cuda:1
      plot:
        sub:
          shape: [4, 2]
          kw:
            figsize: [10, 10]
        int_plotter: ^^null|misfit_toys.beta.plotter|trace_group_stack_plotter
        mode: always
        max_plots: 25
        iter:
          none_dims: [-1]
        save:
          duration: 1000
      atol: 1.0e-02
      rtol: 1.0e-01

    # "3":
    #   name: cdf_lbfgs
    #   loss_fn:
    #     runtime_func: ^^null|misfit_toys.beta.loss|quantile_match
    #     kw:
    #       renorm:
    #         runtime_func: ^^null|misfit_toys.beta.renorm|softplus
    #         kw:
    #           k: 1.0
    #       x: self.unit.beta.conv.x
    #   optimizer:
    #     runtime_func: ^^null|misfit_toys.beta.opt|delay_opt
    #     kw:
    #       opt_type: ^^null|torch.optim|LBFGS
    #       lr: 1.0
    #   data: self.unit.beta.conv.data
    #   init_guess: self.unit.beta.conv.init_guess
    #   device: cuda:1
    #   plot:
    #     sub:
    #       shape: [4, 2]
    #       kw:
    #         figsize: [10, 10]
    #     int_plotter: ^^null|misfit_toys.beta.plotter|trace_group_stack_plotter
    #     mode: always
    #     max_plots: 25
    #     iter:
    #       none_dims: [-1]
    #     save:
    #       duration: 1000
    #   atol: 1.0e-02
    #   rtol: 1.0e-01
